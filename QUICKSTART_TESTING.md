# Universal BI - 快速测试指南

**版本**: v2.0 Final  
**更新日期**: 2026-01-08

---

## 🚀 快速启动

### 1. 启动后端（终端1）

```bash
cd /Users/pusonglin/PycharmProjects/universal-bi/backend
uvicorn app.main:app --reload --port 8000
```

**验证**: 访问 `http://localhost:8000/docs` 应该看到API文档

---

### 2. 启动前端（终端2）

```bash
cd /Users/pusonglin/PycharmProjects/universal-bi/frontend
npm run dev
```

**验证**: 访问 `http://localhost:5173` 应该看到登录页面

---

## 🧪 5分钟快速测试

### 测试1：多轮对话（1分钟）

1. 登录系统
2. 进入"对话分析"页面
3. 选择一个数据集
4. **第一轮**：输入"查询上个月的销售额"
5. 等待结果返回
6. **第二轮**：输入"按城市拆分"（故意省略主语）
7. ✅ **验证**：AI能理解并返回按城市拆分的销售额

---

### 测试2：智能分析展示（1分钟）

1. 在对话页面
2. 输入"查询最近30天的销售额趋势"
3. 等待结果返回
4. ✅ **验证**：图表下方显示"智能分析"蓝色卡片
5. ✅ **验证**：卡片包含统计特征（均值、标准差等）
6. ✅ **验证**：卡片包含趋势分析

---

### 测试3：图表类型切换（1分钟）

1. 继续在对话页面
2. 输入"查询每日销售额"
3. 等待结果返回
4. ✅ **验证**：默认显示折线图
5. ✅ **验证**：图表上方显示切换按钮（柱状图、面积图、表格）
6. 点击"柱状图"按钮
7. ✅ **验证**：图表即时切换为柱状图
8. ✅ **验证**：数据保持一致

---

### 测试4：数据导出（1分钟）

1. 继续使用上一个查询结果
2. 点击图表工具栏的"导出数据"按钮
3. 选择"导出为 Excel"
4. ✅ **验证**：文件自动下载
5. 打开下载的Excel文件
6. ✅ **验证**：数据完整，中文无乱码
7. 重复步骤2-3，选择"导出为 CSV"
8. ✅ **验证**：CSV文件也能正常打开

---

### 测试5：综合流程（1分钟）

1. 输入"查询产品销售额TOP10"
2. ✅ **验证**：显示柱状图或表格
3. ✅ **验证**：显示智能分析
4. 切换为饼图
5. ✅ **验证**：切换成功
6. 导出为Excel
7. ✅ **验证**：导出成功

---

## ✅ 测试通过标准

- [ ] 多轮对话能正确理解上下文
- [ ] 智能分析卡片正常显示
- [ ] 图表类型能即时切换
- [ ] Excel导出成功且无乱码
- [ ] CSV导出成功且无乱码
- [ ] 无JavaScript Console错误
- [ ] 无Network请求失败
- [ ] UI响应流畅

---

## 🐛 常见问题排查

### 问题1：后端启动失败

**错误**: `ModuleNotFoundError: No module named 'xxx'`

**解决**:
```bash
cd /Users/pusonglin/PycharmProjects/universal-bi/backend
pip install -r requirements.txt
```

---

### 问题2：前端启动失败

**错误**: `Cannot find module 'xxx'`

**解决**:
```bash
cd /Users/pusonglin/PycharmProjects/universal-bi/frontend
npm install
```

---

### 问题3：CORS错误

**错误**: `Access to XMLHttpRequest has been blocked by CORS policy`

**解决**:
1. 检查后端配置 `backend/app/core/config.py`
2. 确保 `CORS_ORIGINS = "*"` （开发环境）
3. 重启后端服务

---

### 问题4：导出失败

**错误**: `Failed to fetch` 或 `Network Error`

**可能原因**:
- 后端未启动
- 数据量过大

**解决**:
1. 检查后端服务是否正常运行
2. 检查浏览器Console的详细错误信息
3. 尝试导出较小的数据集

---

### 问题5：多轮对话未生效

**现象**: 第二轮查询没有理解上下文

**排查**:
1. 打开浏览器Console
2. 查看发送的API请求
3. 检查`conversation_history`字段是否存在
4. 检查后端日志是否有查询重写记录

---

## 📊 功能对照表

| 功能 | 后端API | 前端UI | 测试 | 状态 |
|------|---------|--------|------|------|
| 多轮对话上下文 | ✅ | ✅ | ⏳ | 待测试 |
| 智能分析展示 | ✅ | ✅ | ⏳ | 待测试 |
| 图表类型切换 | ✅ | ✅ | ⏳ | 待测试 |
| Excel导出 | ✅ | ✅ | ⏳ | 待测试 |
| CSV导出 | ✅ | ✅ | ⏳ | 待测试 |

---

## 📝 测试记录

**测试人**: ______________  
**测试日期**: ______________  
**测试环境**: 
- 操作系统: ______________
- 浏览器: ______________
- Python版本: ______________
- Node版本: ______________

**测试结果**:
- [ ] 全部通过
- [ ] 部分通过（注明失败项）: ______________
- [ ] 未通过

**备注**: 
```
（在此记录测试过程中发现的问题或建议）







```

---

## 🎯 下一步

测试通过后，可以：

1. **部署到生产环境**
   - 配置生产环境变量
   - 构建前端生产版本
   - 配置Nginx反向代理

2. **性能优化**
   - 添加Redis缓存
   - 优化SQL查询
   - 前端代码分割

3. **功能扩展**
   - 对话历史持久化
   - 批量导出
   - 图表配置保存

---

## 📞 技术支持

如需详细文档，请查看：

- **需求文档**: `docs/general/需求.md`
- **实现报告**: `docs/general/PHASE3_PHASE4_COMPLETION_REPORT.md`
- **集成指南**: `docs/general/FRONTEND_INTEGRATION_GUIDE.md`
- **测试清单**: `docs/general/MANUAL_TEST_CHECKLIST.md`

---

**祝测试顺利！** 🚀

